language: python
python:
- '3.6'
addons:
- postgresql: '9.5'
env:
  matrix:
  - DATABASE_URL=postgres://postgres@localhost/travisdb
  global:
    secure: cBUn22Vl2ZuhHjoYqaZFWjfupZ8QcaXUJVaSN2OMmhCZY/utvOMISXs6EQ7mgfgNqfhiEmy3wvPcw8HkYRnRYbah6QK4/IPHdtrzQNduv8Sc/spirIVouWYR+eu2JCaGl0DOwD0OY3G24hZi61QOVb7ixTeqqq09py0dbqIJtmfKMpudBKOYbgormT4GP4YeWeaQ2G6DrDWFSjHuxqY6FbGRh1cGG9GjgZrSp2rCae3n+mhYvdXdkL2+1OdeZtNdoo05urISJ3ArR6q1fh5bY4DHA0Ina1lG4AWc06CB4k+HGpelO06YP9chGaRVrZkDZ1ulaUD2wFZ65yejiK353OvQN43dth9P+yE7HptoJLDIltEyHYLJV1x5EV6FEyQ74dtDmIWxrRsfm068LvNOhh7aP6pW6TAkYWuNzTwv/Dho5Mc3T4d1lwIHwdFfoqm7JFGPyx+tA6nUpZxCmPxsL3BWgpgpaHR3rdZMgzB4GQVSB+0RwVoxT7NmzDhgx0/mVszQsp4EHHOg8ersdBOG6pkwcwcsr8/BQPOPEgzGxq/4NSInyzx0k0DwLJ8pwcyQximmnYvn4VkSiUFkqOGR7q0aDDDP/Phta0Te8ao0Hr0Th90EtJXQjP/ODoQpPkqKIfzf+XzP8jTAWKGDv+jqT7RqE15EPrhDzy0mOO7BuQQ=
before_install:
- export DJANGO_SETTINGS_MODULE=DinDinAPI.settings
- export PYTHONPATH=$HOME/builds/flyiniggle/DinDinAPI
- export PIP_USE_MIRRORS=true
install:
- pip install -r requirements.txt
before_script:
- psql -c "CREATE DATABASE travisdb;" -U postgres
script:
- python manage.py migrate
- coverage run manage.py test --pattern="*Test.py"
after_success:
- coveralls
deploy:
  - provider: heroku
    api_key:
      secure: Av6CrAqz6frz+v4cbc5/aELgO75Eo6jWCy2CrsYzxo/yALgS0638AUG1XFxNy+Qg7FBI/2OTIuWKf0/0adFnf9E3rk2OwH0mIcQFxsjjJdq1ig0lSyCtJDxztP0BTxNzDfcND7CQtxxgQAiZUqP1HLnoKWPe7Xr9KN5K01ccoKUcilIjqqK1Rzr4++poUFWuqGHhraALwCinl9vw+5phWnPRTy1Nj/bwPlCMGBGd0PAlR1Oo8hi+Ed0oAzwh0bN/vQl5e56BL/dcdQ1dR+gNZPK8FWgKFz6dp+2GSvlKAda0yyS47S+fBx2EAi62CCi4wUAHNDDOfyMugXgEq1u+KW1fMXalMiIWzHvbw38EKSPmBMTk8/eqRrAQkHYDcAqIJZrixRa7eMJ6vKHKdxXojkveij3sgVVGWTqKJwX/EVmlQfNtWFp9GZaMomHDWPpu5cqnUxTYV3g79A8q8i8SkNw3qkXUHmykAiSfpEWrhjVJ5ZFGJ9DdLiGKcVZXy33FPQ01FA3JD2wPU2tdCCtM5jS2M7n0EX8BJ5EJSONdmNaNh3nzq/ysEJSREgowvJIY61USb25OPVKnJMNc/KFZMw+qHnp31Nh/A1VjqITOnDzZmhqIngQhXlEukY8dqlhX8buaONIhkE+HLZ8+aXjh5Fxo09yPfugnnxFKM72jsaI=
    app: dindinwebapi
    on:
      repo: flyiniggle/DinDinAPI
      tags: true
  - provider: heroku
    api_key:
      secure: Av6CrAqz6frz+v4cbc5/aELgO75Eo6jWCy2CrsYzxo/yALgS0638AUG1XFxNy+Qg7FBI/2OTIuWKf0/0adFnf9E3rk2OwH0mIcQFxsjjJdq1ig0lSyCtJDxztP0BTxNzDfcND7CQtxxgQAiZUqP1HLnoKWPe7Xr9KN5K01ccoKUcilIjqqK1Rzr4++poUFWuqGHhraALwCinl9vw+5phWnPRTy1Nj/bwPlCMGBGd0PAlR1Oo8hi+Ed0oAzwh0bN/vQl5e56BL/dcdQ1dR+gNZPK8FWgKFz6dp+2GSvlKAda0yyS47S+fBx2EAi62CCi4wUAHNDDOfyMugXgEq1u+KW1fMXalMiIWzHvbw38EKSPmBMTk8/eqRrAQkHYDcAqIJZrixRa7eMJ6vKHKdxXojkveij3sgVVGWTqKJwX/EVmlQfNtWFp9GZaMomHDWPpu5cqnUxTYV3g79A8q8i8SkNw3qkXUHmykAiSfpEWrhjVJ5ZFGJ9DdLiGKcVZXy33FPQ01FA3JD2wPU2tdCCtM5jS2M7n0EX8BJ5EJSONdmNaNh3nzq/ysEJSREgowvJIY61USb25OPVKnJMNc/KFZMw+qHnp31Nh/A1VjqITOnDzZmhqIngQhXlEukY8dqlhX8buaONIhkE+HLZ8+aXjh5Fxo09yPfugnnxFKM72jsaI=
    app: dindinwebapi-staging
    on:
      repo: flyiniggle/DinDinAPI
      branch: master